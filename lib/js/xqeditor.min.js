(function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=t():"function"==typeof define&&define.amd?define(t()):"function"==typeof define&&define.cmd?define(function(e,i,o){o.exports=t()}):e.XqEditor=t()})(this,function(){function e(e={el:""}){if(this.options=e,!this.options.el)throw new Error("XqEditor: el is must selector!");this.editor={value:"",preview:"",words:0,lineNum:0,isScroll:!0,isScale:!1,isPreview:!1,isEdit:!1,isInfo:!1,files:null},this.upload={type:"image",url:""},this.initElem(document.querySelector(this.options.el))}return e.prototype.initElem=function(e){let t=document.createElement("div");t.className="xqeditor",t.innerHTML='<div class="xqeditor-editor">\n            <div class="xqeditor-editor-set">\n                <div class="xqeditor-editor-set-title">\n                    <i class="fa fa-edit"></i>\n                    <span>XQ Editor</span>\n                </div>\n                <div class="xqeditor-editor-set-btn">\n                    <button title="粗体" class="xqeditor-bold">\n                        <i title="粗体" class="fa fa-bold"></i>\n                    </button>\n                    <button title="斜体" class="xqeditor-italic">\n                        <i title="斜体" class="fa fa-italic"></i>\n                    </button>\n                    <button title="引用" class="xqeditor-quote">\n                        <i title="引用" class="fa fa-quote-left"></i>\n                    </button>\n                    <button title="列表" class="xqeditor-list">\n                        <i title="列表" class="fa fa-list"></i>\n                    </button>\n                    <button title="链接" class="xqeditor-link">\n                        <i title="链接" class="fa fa-link"></i>\n                    </button>\n                    <button class="file" title="图片">\n                        <i title="图片" class="fa fa-image"></i>\n                        <input type="file" name="file" id="file" accept="image/*">\n                    </button>\n                    <button title="代码块" class="xqeditor-code">\n                        <i title="代码块" class="fa fa-code"></i>\n                    </button>\n                    <button title="代码段" class="xqeditor-code-block">\n                        <i title="代码段" class="fa fa-file-code"></i>\n                    </button>\n                    <button title="表格" class="xqeditor-table">\n                        <i title="表格" class="fa fa-table"></i>\n                    </button>\n                    <button title="只显示编辑框" class="xqeditor-show-editor">\n                        <i title="只显示编辑框" class="fa fa-eye-slash"></i>\n                    </button>\n                    <button title="只显示预览" class="xqeditor-show-preview">\n                        <i title="只显示预览" class="fa fa-desktop"></i>\n                    </button>\n                    <button title="缩放"  class="xqeditor-scale-editor">\n                        <i title="缩放" class="fa fa-arrows-alt"></i>\n                    </button>\n                    <button title="信息" class="xqeditor-show-info">\n                        <i title="信息" class="fa fa-info-circle"></i>\n                    </button>\n                </div>\n            </div>\n            <div class="xqeditor-editor-ipt">\n                <div class="xqeditor-editor-code scroll-box">\n                    <div id="markdown-code">\n                        <div name="leftnum" id="leftnum" wrap="soft"></div>\n                        <textarea name="code" class="scroll-box" id="code" wrap="soft"></textarea>\n                    </div>\n                </div>\n                <div class="xqeditor-editor-preview">\n                    <div id="xqeditor-preview" class="markdown-body scroll-box"></div>\n                </div>\n            </div>\n            <div class="xqeditor-editor-status">\n                <p>字数:<strong id="xqeditor-words">0</strong>,行数:<strong id="xqeditor-lineNum">0</strong>\n                </p>\n                <p>\n                    <input id="isScroll" checked type="checkbox"><span>同步滚动</span>\n                    <span class="xqeditor-editor-gotop">到顶部</span>\n                </p>\n            </div>\n            <div class="xqeditor-info hide">\n                <div class="xqeditor-info-close"><i class="fa fa-times"></i></div>\n                <h2><i class="fa fa-edit"></i> XQ Editor</h2>\n                <div>\n                    <p>小奇编辑器是一款轻巧的Markdown编辑器，包含最常用的功能。</p>\n                    <p>目前版本：V0.0.1</p>\n                    <p>作者：gitguanqi</p>\n                    <p>联系方式：<a href="mailto:contact@guanqi.xyz"><i class="fa fa-envelope"></i> contact@guanqi.xyz</a></p>\n                    <p>源码地址：<a href="https://github.com/gitguanqi/xqeditor/" target="_blank">Github <i\n                                class="fa fa-share"></i></a></p>\n                </div>\n            </div>\n        </div>\n        ',e.appendChild(t),this.addEvent()},e.prototype.addEvent=function(){let e=document.querySelector(".xqeditor-scale-editor"),t=document.querySelector(".xqeditor-show-editor"),i=document.querySelector(".xqeditor-bold"),o=document.querySelector(".xqeditor-italic"),n=document.querySelector(".xqeditor-quote"),d=document.querySelector(".xqeditor-list"),l=document.querySelector(".xqeditor-link"),r=document.querySelector(".xqeditor-code"),s=document.querySelector("#code"),c=document.querySelector("#file"),a=document.querySelector(".xqeditor-editor-gotop"),u=document.querySelector(".xqeditor-code-block"),p=document.querySelector(".xqeditor-table"),h=document.querySelector(".xqeditor-show-preview"),f=document.querySelector(".xqeditor-show-info"),m=document.querySelector(".xqeditor-info-close");a.addEventListener("click",()=>{this.goTop()},!1),s.addEventListener("scroll",()=>{this.changeScroll()},!1),s.addEventListener("keyup",e=>{this.showLineNum(e)},!1),s.addEventListener("change",()=>{this.showPreview()},!1),s.addEventListener("input",()=>{this.showPreview()},!1),i.addEventListener("click",()=>{this.addEditor("bold")},!1),o.addEventListener("click",()=>{this.addEditor("italic")},!1),n.addEventListener("click",()=>{this.addEditor("quote")},!1),d.addEventListener("click",()=>{this.addEditor("list")},!1),l.addEventListener("click",()=>{this.addEditor("link")},!1),r.addEventListener("click",()=>{this.addEditor("code")},!1),u.addEventListener("click",()=>{this.addEditor("codeBlock")},!1),p.addEventListener("click",()=>{this.addEditor("table")},!1),c.addEventListener("change",e=>{this.uploadImg(e)},!1),t.addEventListener("click",()=>{this.toggleEditorMode("edit")},!1),h.addEventListener("click",()=>{this.toggleEditorMode("preview")},!1),e.addEventListener("click",()=>{this.scaleEditor()},!1),f.addEventListener("click",()=>{this.showEditorInfo(!0)},!1),m.addEventListener("click",()=>{this.showEditorInfo(!1)},!1)},e.prototype.showEditor=function(e=""){this.showLineNum({target:{value:this.editor.value}}),this.showPreview(),this.calcWordAndLine(e)},e.prototype.showLineNum=function(e){let t=document.getElementById("leftnum"),i=e.target.value;i=i.replace(/\r/gi,""),i=i.split("\n");let o=i.length,n="";for(let e=1;e<o+1;e++)n+=e+"\n";t.innerText=n,n=""},e.prototype.changeScroll=function(){let e=document.getElementById("xqeditor-preview"),t=document.getElementById("leftnum"),i=document.getElementById("code"),o=document.getElementById("isScroll");t.scrollTop=i.scrollTop,o.checked&&(e.scrollTop=i.scrollTop+100)},e.prototype.showPreview=function(){let e=document.getElementById("code"),t=document.getElementById("xqeditor-preview"),i=e.value,o=markdownit({highlight:(e,t)=>{if(t&&hljs.getLanguage(t))try{return hljs.highlight(t,e).value}catch(e){throw new Error(e)}return""}});var n=o.render(i);t.innerHTML=n,this.editor.code=i,this.editor.preview=n,this.calcWordAndLine(i)},e.prototype.calcWordAndLine=function(e){let t=document.getElementById("xqeditor-words"),i=document.getElementById("xqeditor-lineNum");if(e){let o=e.length,n=e.split("\n").length;t.innerText=o,i.innerText=n}},e.prototype.goTop=function(){let e=document.getElementById("xqeditor-preview"),t=document.querySelector("#code");e.scrollTop=0,t.scrollTop=0},e.prototype.getVal=function(){let e=document.getElementById("xqeditor-preview"),t=document.querySelector("#code");return{text:t.value,html:e.innerHTML}},e.prototype.setVal=function(e){let t=document.querySelector("#code");this.editor.value=e,t.value=e,this.showPreview()},e.prototype.addEditor=function(e,t=""){let i=document.getElementById("code"),o=i.value,n={bold:"\n**加粗内容**\n",italic:"\n*斜体内容*\n",quote:"\n> 引用写这里\n",image:e=>`\n![图片描述](${e})\n`,list:"\n+ 列表项目一\n",link:"\n[链接名称](链接地址)\n",code:"\n`code`\n",codeBlock:"\n```js\ncode block\n```\n",table:"\n |表头|表头| \n |----|----| \n |单元格|单元格| \n |单元格|单元格| \n"},d=n[e];"image"==e&&(d=n.image(t)),o+=d,i.value=o,this.showPreview(),this.showLineNum({target:{value:o}})},e.prototype.uploadImg=async function(e){let t=e.target.files;this.editor.files=t},e.prototype.toggleEditorMode=function(e){let t=document.querySelector(".xqeditor-editor");"edit"==e?(this.editor.isPreview=!1,this.editor.isEdit=!this.editor.isEdit,t.classList.remove("preview"),t.classList.toggle("edit")):(this.editor.isEdit=!1,this.editor.isPreview=!this.editor.isPreview,t.classList.remove("edit"),t.classList.toggle("preview"))},e.prototype.scaleEditor=function(){let e=document.querySelector(".xqeditor-editor");this.editor.isScale=!this.editor.isScale,this.editor.isScale?e.classList.add("scale"):e.classList.remove("scale")},e.prototype.showEditorInfo=function(e){let t=document.querySelector(".xqeditor-info");e?t.classList.remove("hide"):t.classList.add("hide")},e});